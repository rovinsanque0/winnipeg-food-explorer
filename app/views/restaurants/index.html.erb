<div class="d-flex justify-content-between align-items-center mb-4">
  <h1 class="fw-bold">Restaurants</h1>
</div>

<div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
  <% @restaurants.each do |r| %>
    <div class="col">
      <div class="card h-100 shadow-sm border-0">
        <div class="card-body">

          <!-- Name -->
          <h5 class="card-title">
            <%= link_to r.name, r, class: "text-decoration-none fw-semibold" %>
          </h5>

          <!-- Address -->
          <p class="text-muted mb-1">
            <%= r.address %>
          </p>

          <!-- Ward -->
          <p class="mb-2">
            <small class="fw-light text-secondary">
              <strong>Ward:</strong> <%= r.ward&.name || "N/A" %>
            </small>
          </p>

          <!-- Categories -->
          <% if r.categories.any? %>
            <% r.categories.each do |c| %>
              <span class="badge bg-secondary me-1"><%= c.name %></span>
            <% end %>
          <% else %>
            <span class="badge bg-light text-muted border">Uncategorized</span>
          <% end %>

          <!-- Inspection preview -->
          <% last_inspection = r.inspections.order(inspected_on: :desc).first %>

          <% if last_inspection %>
            <hr class="my-2">
            <p class="small mb-0">
              <strong>Last Inspection:</strong>
              <%= last_inspection.inspected_on.strftime("%b %d, %Y") rescue last_inspection.inspected_on %>
              <br>
              <span class="<%= last_inspection.outcome == 'Pass' ? 'text-success' : last_inspection.outcome == 'Fail' ? 'text-danger' : 'text-warning' %>">
                <%= last_inspection.outcome %>
              </span>
            </p>
          <% end %>

        </div>

        <!-- footer -->
        <div class="card-footer bg-transparent border-0">
          <%= link_to "View Details â†’", r, class: "btn btn-sm btn-outline-primary w-100" %>
        </div>

      </div>
    </div>
  <% end %>
</div>

<div class="mt-4">
  <%= paginate @restaurants %>
</div>
